<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- explicit list view definition colors="grey:state == 'done'" -->
        <record model="ir.ui.view" id="ng_internal_requisition_list">
            <field name="name">ng_internal_requisition list</field>
            <field name="model">ng.ir.request</field>
            <field name="arch" type="xml">
                <list>
                    <field name="name" />
                    <field name="requester" />
                    <field name="end_user" />
                    <field name="request_date" />
                    <field name="request_deadline" />
                    <field name="state" />
                </list>
            </field>
        </record>
<!--        <record id="ng_internal_requisition_form_1_01" model="ir.ui.view">-->
<!--            <field name="name">ng_internal_requisition form</field>-->
<!--            <field name="model">ng.ir.request</field>-->
<!--            <field name="arch" type="xml">-->
<!--                <form>-->
<!--                    <header>-->
<!--                        &lt;!&ndash; user &ndash;&gt;-->
<!--                        <button name="submit" states="draft"-->
<!--                                string="Submit To HOD" type="object"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_user"-->
<!--                                class="oe_highlight" />-->
<!--                        &lt;!&ndash; department manager &ndash;&gt;-->
<!--                        <button name="department_manager_approve"-->
<!--                                states="submit" string="Approve By HOD"-->
<!--                                type="object"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_dept_manager"-->
<!--                                context="{'approved':True}" class="oe_highlight" />-->
<!--                        <button name="department_manager_approve"-->
<!--                                states="submit" string="Reject By HOD"-->
<!--                                type="object"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_dept_manager"-->
<!--                                context="{'approved':False}" />-->
<!--                        &lt;!&ndash; Finance (main manager)&ndash;&gt;-->
<!--                        <button name="store_officer_approve"-->
<!--                                states="approved" string="Approve By Finance" type="object"-->
<!--                                context="{'approved':True}" class="oe_highlight"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_finance" />-->
<!--                        &lt;!&ndash;                        <button name="check_quantity_available" states="approved" string="Confirm Available Quantity" type="object" groups="ng_internal_requisition.ng_internal_requisition_stock_officer" class="oe_link" />&ndash;&gt;-->
<!--                        <button name="store_officer_approve" states="approved"-->
<!--                                string="Reject By Finance" type="object" context="{'approved':False}"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_finance" />-->

<!--                        <button name="internal_confirmation" states="audit" string="Approve By Procurement"-->
<!--                                type="object" context="{'approved':True}" class="oe_highlight"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_procurement" />-->
<!--                        <button name="internal_confirmation" states="audit" string="Reject By Procurement"-->
<!--                                type="object" groups="ng_internal_requisition.ng_internal_requisition_procurement"-->
<!--                                context="{'approved':False}" />-->

<!--                        &lt;!&ndash;                        <button name="plant_manager_approve" states="approval" string="Approve" type="object" class="oe_highlight" context="{'approved':True}"/>&ndash;&gt;-->
<!--                        &lt;!&ndash;                        <button name="plant_manager_approve" states="approval" string="Reject" type="object" groups="masterenergy_base_approval.group_internal_audit" context="{'approved':False}" />&ndash;&gt;-->

<!--                        &lt;!&ndash;                        <button name="accept_requisition" states="ready" string="Accept" type="object" class="oe_highlight" />&ndash;&gt;-->
<!--                        <field name="state" widget="statusbar" statusbar_visible="draft,submit,approved,done"/>-->
<!--                    </header>-->
<!--                    <sheet>-->
<!--                        <group>-->
<!--                            <group>-->
<!--&lt;!&ndash;                                <field name="availaibility" invisible="1" />&ndash;&gt;-->
<!--                                <field name="name" readonly="1" />-->
<!--                                <field name="requester" required="1" readonly="1" force_save="1"/>-->
<!--                                <field name="request_date" required="1" readonly="1" force_save="1"/>-->
<!--                                <field name="request_deadline" required="0"/>-->
<!--                                <field name="warehouse_id" states="warehouse" attrs="{'required' : [('state', '=', 'warehouse')]}" />-->
<!--                                <field name="company_id" invisible="1"/>-->
<!--                            </group>-->
<!--                            <group>-->
<!--                                <field name="end_user" readonly="1" force_save="1"/>-->
<!--                                <field name="hod" attrs="{'readonly': [('state', '!=', 'draft')]}"/>-->
<!--                                <field name="department" readonly="1" force_save="1"/>-->
<!--                            </group>-->
<!--                            <group>-->
<!--&lt;!&ndash;                                <field name="src_location_id" domain="[('usage', '=', 'internal')]" attrs="{'required' : [('state', 'in', ['audit','approved', 'approval'])]}" states="approval,audit,approved" />&ndash;&gt;-->
<!--                                <field name="purchase_agreement_id" force_save="1" attrs="{'invisible': [('is_purchase_agreement', '=', False)]}" invisible="1"/>-->
<!--                                <field name="is_purchase_agreement" invisible="1"/>-->
<!--                            </group>-->
<!--                            <group>-->
<!--&lt;!&ndash;                                <field name="dst_location_id" states="approval,audit,approved" attrs="{'required' : [('state', 'in',&ndash;&gt;-->
<!--&lt;!&ndash;                                    ['approval', 'audit', 'approved'])]}" domain="[('usage', '!=', 'view')]" />&ndash;&gt;-->
<!--                            </group>-->
<!--                        </group>-->
<!--                        <notebook>-->
<!--                            &lt;!&ndash;                            <page string='Rejection Reason' attrs="{'invisible': ['|', ('reason', '=', False), ('state', '!=', 'draft')]}">&ndash;&gt;-->
<!--                            <page string='Rejection Reason' attrs="{'invisible': [('reason', '=', False)]}">-->
<!--                                <field name="reason" readonly="1" />-->
<!--                            </page>-->
<!--                            <page string='Requisition'>-->
<!--                                <field name="approve_request_ids">-->
<!--                                    <list editable='bottom'>-->
<!--                                        <field name="product_id" required="1" />-->
<!--                                        <field name="quantity" required="1" />-->
<!--                                        <field name="uom" />-->
<!--                                        &lt;!&ndash;                                        <field name="qty" string="Avail Qty" />&ndash;&gt;-->
<!--                                        <field name="purchase_agreement_id" />-->
<!--                                        &lt;!&ndash;                                        <field name="to_procure" invisible="1" />&ndash;&gt;-->
<!--                                        &lt;!&ndash;                                        <field name="transferred" readonly="1" />&ndash;&gt;-->
<!--                                        &lt;!&ndash;                                        <field name="state" string="State" />&ndash;&gt;-->
<!--                                        &lt;!&ndash;                                        <field name="button_show_state" invisible="1" />&ndash;&gt;-->
<!--                                        &lt;!&ndash;                                        <button name="procure" type="object" string="Procure" class="oe_link" attrs="{'invisible': [('state', 'in', ['available', 'awaiting'])]}" groups="masterenergy_base_approval.group_store_officer" />&ndash;&gt;-->
<!--                                    </list>-->
<!--                                </field>-->
<!--                            </page>-->
<!--                        </notebook>-->
<!--                    </sheet>-->
<!--                     <chatter/>-->
<!--&lt;!&ndash;                    <div class="oe_chatter">&ndash;&gt;-->
<!--&lt;!&ndash;                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user" />&ndash;&gt;-->
<!--&lt;!&ndash;                        <field name="message_ids" widget="mail_thread" />&ndash;&gt;-->
<!--&lt;!&ndash;                    </div>&ndash;&gt;-->
<!--                </form>-->
<!--            </field>-->
<!--        </record>-->
        <record id="ng_internal_requisition_form_1_01" model="ir.ui.view">
        <field name="name">ng_internal_requisition.form</field>
        <field name="model">ng.ir.request</field>
        <field name="arch" type="xml">
        <form>
            <header>
                <!-- User -->
                <button name="submit" string="Submit To HOD" type="object"
                        class="oe_highlight"
                        groups="ng_internal_requisition.ng_internal_requisition_user"
                        invisible="not state == 'draft'"/>

                <!-- Department Manager / HOD -->
                <button name="department_manager_approve" string="Approve By HOD" type="object"
                        class="oe_highlight"
                        groups="ng_internal_requisition.ng_internal_requisition_dept_manager"
                        context="{'approved': True}"
                        invisible="not state == 'submit'"/>
                <button name="department_manager_approve" string="Reject By HOD" type="object"
                        groups="ng_internal_requisition.ng_internal_requisition_dept_manager"
                        context="{'approved': False}"
                        invisible="not state == 'submit'"/>

                <!-- Finance -->
                <button name="store_officer_approve" string="Approve By Finance" type="object"
                        class="oe_highlight"
                        groups="ng_internal_requisition.ng_internal_requisition_finance"
                        context="{'approved': True}"
                        invisible="not state == 'approved'"/>
                <button name="store_officer_approve" string="Reject By Finance" type="object"
                        groups="ng_internal_requisition.ng_internal_requisition_finance"
                        context="{'approved': False}"
                        invisible="not state == 'approved'"/>

                <!-- Procurement -->
                <button name="internal_confirmation" string="Approve By Procurement" type="object"
                        class="oe_highlight"
                        groups="ng_internal_requisition.ng_internal_requisition_procurement"
                        context="{'approved': True}"
                        invisible="not state == 'audit'"/>
                <button name="internal_confirmation" string="Reject By Procurement" type="object"
                        groups="ng_internal_requisition.ng_internal_requisition_procurement"
                        context="{'approved': False}"
                        invisible="not state == 'audit'"/>

                <!-- Statusbar -->
                <field name="state" widget="statusbar"
                       statusbar_visible="draft,submit,approved,audit,done"/>
            </header>

            <sheet>
                <group>
                    <group>
                        <field name="name" readonly="True"/>
                        <field name="requester" required="True" readonly="True"/>
                        <field name="request_date" required="True" readonly="True"/>
                        <field name="request_deadline"/>
                        <field name="warehouse_id" required="state == 'warehouse'"/>
                        <field name="company_id" invisible="True"/>
                    </group>
                    <group>
                        <field name="end_user" readonly="True"/>
                        <field name="hod" readonly="state != 'draft'"/>
                        <field name="department" readonly="True"/>
                    </group>
                    <group>
                        <field name="purchase_agreement_id" invisible="not is_purchase_agreement"/>
                        <field name="is_purchase_agreement" invisible="True"/>
                    </group>
                </group>

                <notebook>
                    <!-- Rejection Reason -->
                    <page string="Rejection Reason" invisible="reason == False">
                        <field name="reason" readonly="True"/>
                    </page>

                    <!-- Requisition Lines -->
                    <page string="Requisition">
                        <field name="approve_request_ids">
                            <list editable="bottom">
                                <field name="product_id" required="1" readonly="parent_state in ['submit','approved','cpo','done']"/>
                                <field name="quantity" required="1" readonly="parent_state in ['submit','approved','cpo','done']"/>
                                <field name="uom" readonly="parent_state in ['submit','approved','cpo','done']"/>
                                <field name="purchase_agreement_id"/>
                            </list>
                        </field>
<!--                        <field name="approve_request_ids">-->
<!--                            <list editable="bottom">-->
<!--                                <field name="product_id" required="True"-->
<!--                                       readonly="model.state in ['submit','approved','cpo','done']"/>-->
<!--                                <field name="quantity" required="True"-->
<!--                                       readonly="model.state in ['submit','approved','cpo','done']"/>-->
<!--                                <field name="uom"-->
<!--                                       readonly="model.state in ['submit','approved','cpo','done']"/>-->
<!--                                <field name="purchase_agreement_id"/>-->
<!--                            </list>-->
<!--                        </field>-->
                    </page>
                </notebook>
            </sheet>

            <chatter/>
        </form>
    </field>
</record>


        <!-- actions opening views on models -->
        <record model="ir.actions.act_window" id="ng_internal_requisition_action_window">
            <field name="name">Purchase Requisition</field>
            <field name="res_model">ng.ir.request</field>
            <field name="view_mode">list,form</field>
            <field name="context">{'default_request_type': 'purchase'}</field>
            <field name="domain">[('request_type', '=', 'purchase')]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                </p>
            </field>
        </record>
        <!-- Top menu item -->
        <!--        <menuitem name="Store Requisition" -->
        <!--                  id="ng_internal_requisition_menu_root" -->
        <!--                  web_icon="ng_internal_requisition,static/description/icon.png" />-->
        <!-- menu categories -->
        <!--        parent="ng_internal_requisition_menu_root"-->
        <menuitem name="Purchase Requisition"
                  id="purcahse_requisition_menu"
                  web_icon="ng_internal_requisition,static/description/icon.png"
                  action="ng_internal_requisition_action_window" />
        <!--        <menuitem name="Sale Requisition" id="sale_requisition_menu" parent="ng_internal_requisition_menu_root" action="ng_internal_requisition_action_window" />-->
        <!-- actions -->
    </data>
</odoo>