<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- explicit list view definition colors="grey:state == 'done'" -->
<!--        <record model="ir.ui.view" id="ng_store_requisition_list">-->
<!--            <field name="name">ng_store_requisition list</field>-->
<!--            <field name="model">ng.store.request</field>-->
<!--            <field name="arch" type="xml">-->
<!--                <list>-->
<!--                    <field name="name" />-->
<!--                    <field name="requester" />-->
<!--                    <field name="end_user" />-->
<!--                    <field name="request_date" />-->
<!--                    <field name="request_deadline" />-->
<!--                    <field name="state" />-->
<!--                </list>-->
<!--            </field>-->
<!--        </record>-->
<!--        <record id="ng_store_requisition_form_1_01" model="ir.ui.view">-->
<!--            <field name="name">ng_store_requisition form</field>-->
<!--            <field name="model">ng.store.request</field>-->
<!--            <field name="arch" type="xml">-->
<!--                <form>-->
<!--                    <header>-->
<!--                        &lt;!&ndash; user &ndash;&gt;-->
<!--                        <button name="submit" states="draft"-->
<!--                                string="Submit To HOD" type="object"-->
<!--                                groups="ng_store_requisition.ng_store_requisition_user"-->
<!--                                class="oe_highlight" />-->
<!--                        &lt;!&ndash; department manager &ndash;&gt;-->
<!--                        <button name="department_manager_approve"-->
<!--                                states="submit" string="Approve By HOD"-->
<!--                                type="object"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_dept_manager"-->
<!--                                context="{'approved':True}" class="oe_highlight" />-->
<!--                        <button name="department_manager_approve"-->
<!--                                states="submit" string="Reject By HOD"-->
<!--                                type="object"-->
<!--                                groups="ng_internal_requisition.ng_internal_requisition_dept_manager"-->
<!--                                context="{'approved':False}" />-->
<!--                        &lt;!&ndash; Finance (main manager)&ndash;&gt;-->
<!--                        <button name="store_officer_approve"-->
<!--                                states="approved" string="Approve By Inventory Manager" type="object"-->
<!--                                context="{'approved':True}" class="oe_highlight"-->
<!--                                groups="ng_store_requisition.ng_store_requisition_finance" />-->
<!--&lt;!&ndash;                        <button name="check_quantity_available" states="approved" string="Confirm Available Quantity" type="object" groups="ng_internal_requisition.ng_internal_requisition_stock_officer" class="oe_link" />&ndash;&gt;-->
<!--                        <button name="store_officer_approve" states="approved"-->
<!--                                string="Reject By Inventory Manager" type="object" context="{'approved':False}"-->
<!--                                groups="ng_store_requisition.ng_store_requisition_finance" />-->

<!--                        <button name="internal_confirmation" states="cpo" string="Approve By CPO"-->
<!--                                type="object" context="{'approved':True}" class="oe_highlight"-->
<!--                                groups="ng_store_requisition.ng_store_requisition_procurement" />-->
<!--                        <button name="internal_confirmation" states="cpo" string="Reject By CPO"-->
<!--                                type="object" groups="ng_store_requisition.ng_store_requisition_procurement"-->
<!--                                context="{'approved':False}" />-->

<!--&lt;!&ndash;                        <button name="plant_manager_approve" states="approval" string="Approve" type="object" class="oe_highlight" context="{'approved':True}"/>&ndash;&gt;-->
<!--&lt;!&ndash;                        <button name="plant_manager_approve" states="approval" string="Reject" type="object" groups="masterenergy_base_approval.group_internal_audit" context="{'approved':False}" />&ndash;&gt;-->

<!--&lt;!&ndash;                        <button name="accept_requisition" states="ready" string="Accept" type="object" class="oe_highlight" />&ndash;&gt;-->
<!--                        <field name="state" widget="statusbar" statusbar_visible="draft,submit,approved,done"/>-->
<!--                    </header>-->
<!--                    <sheet>-->
<!--                        <field name="release_good"  states="approved,cpo" readonly="1">-->
<!--                        </field>-->
<!--                        <group>-->
<!--                            <group>-->
<!--                                <field name="availaibility" invisible="1" />-->
<!--                                <field name="name" readonly="1" />-->
<!--                                <field name="requester" required="1" attrs="{'readonly': [('state', '!=', 'draft')]}" />-->
<!--                                <field name="request_date" required="1" attrs="{'readonly': [('state', '!=', 'draft')]}" />-->
<!--                                <field name="request_deadline" required="0" attrs="{'readonly': [('state', '!=', 'draft')]}" />-->
<!--                                <field name="warehouse_id" states="warehouse" attrs="{'required' : [('state', '=', 'warehouse')]}" />-->
<!--                                <field name="company_id" invisible="1"/>-->
<!--                            </group>-->
<!--                            <group>-->
<!--                                <field name="end_user" attrs="{'readonly': [('state', '!=', 'draft')]}" />-->
<!--                                <field name="hod" attrs="{'readonly': [('state', '!=', 'draft')]}"/>-->
<!--                                <field name="department" attrs="{'readonly': [('state', '!=', 'draft')]}" />-->
<!--                                <field name="purchase_requisition_id" force_save="1" attrs="{'invisible': [('state', 'in', ['draft','submit'])]}" />-->
<!--                            </group>-->
<!--                            <group>-->
<!--                                <field name="src_location_id" domain="[('usage', '=', 'internal')]" attrs="{'required' : [('state', 'in', ['audit','approved', 'approval'])]}" states="approval,audit,approved" />-->
<!--                            </group>-->
<!--                            <group>-->
<!--                                <field name="dst_location_id" states="approval,audit,approved" attrs="{'required' : [('state', 'in',-->
<!--                                    ['approval', 'audit', 'approved'])]}" domain="[('usage', '!=', 'view')]" />-->
<!--                            </group>-->
<!--                        </group>-->
<!--                        <notebook>-->
<!--                            <page string='Rejection Reason' attrs="{'invisible': ['|', ('reason', '=', False), ('state', '!=', 'draft')]}">-->
<!--                                <field name="reason" readonly="1" />-->
<!--                            </page>-->
<!--                            <page string='Requisition'>-->
<!--                                <field name="approve_request_ids">-->
<!--                                    <list editable='bottom'>-->
<!--                                        <field name="product_id" required="1" />-->
<!--                                        <field name="quantity" required="1" />-->
<!--                                        <field name="uom" />-->
<!--                                        <field name="qty" string="Avail Qty" />-->
<!--                                        <field name="to_procure" invisible="1" />-->
<!--                                        <field name="transferred" readonly="1" />-->
<!--                                        <field name="state" string="State" />-->
<!--                                        <field name="button_show_state" invisible="1" />-->
<!--                                        <button name="procure" type="object" string="Procure" class="oe_link" attrs="{'invisible': [('state', 'in', ['available', 'awaiting'])]}" groups="masterenergy_base_approval.group_store_officer" />-->
<!--                                    </list>-->
<!--                                </field>-->
<!--                            </page>-->
<!--                        </notebook>-->
<!--                    </sheet>-->
<!--                     <chatter/>-->
<!--&lt;!&ndash;                    <div class="oe_chatter">&ndash;&gt;-->
<!--&lt;!&ndash;                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user" />&ndash;&gt;-->
<!--&lt;!&ndash;                        <field name="message_ids" widget="mail_thread" />&ndash;&gt;-->
<!--&lt;!&ndash;                    </div>&ndash;&gt;-->
<!--                </form>-->
<!--            </field>-->
<!--        </record>-->
        <record model="ir.ui.view" id="ng_store_requisition_list">
    <field name="name">ng_store_requisition list</field>
    <field name="model">ng.store.request</field>
    <field name="arch" type="xml">
        <list>
            <field name="name" />
            <field name="requester" />
            <field name="end_user" />
            <field name="request_date" />
            <field name="request_deadline" />
            <field name="state" />
        </list>
    </field>
</record>

<record id="ng_store_requisition_form_1_01" model="ir.ui.view">
    <field name="name">ng_store_requisition form</field>
    <field name="model">ng.store.request</field>
    <field name="arch" type="xml">
        <form>
            <header>
                <!-- user -->
                <button name="submit" invisible="state != 'draft'"
                        string="Submit To HOD" type="object"
                        groups="ng_store_requisition.ng_store_requisition_user"
                        class="oe_highlight" />
                <!-- department manager -->
                <button name="department_manager_approve"
                        invisible="state != 'submit'" string="Approve By HOD"
                        type="object"
                        groups="ng_internal_requisition.ng_internal_requisition_dept_manager"
                        context="{'approved':True}" class="oe_highlight" />
                <button name="department_manager_approve"
                        invisible="state != 'submit'" string="Reject By HOD"
                        type="object"
                        groups="ng_internal_requisition.ng_internal_requisition_dept_manager"
                        context="{'approved':False}" />
                <!-- Finance (main manager)-->
                <button name="store_officer_approve"
                        invisible="state != 'approved'" string="Approve By Inventory Manager" type="object"
                        context="{'approved':True}" class="oe_highlight"
                        groups="ng_store_requisition.ng_store_requisition_finance" />
                <button name="store_officer_approve" invisible="state != 'approved'"
                        string="Reject By Inventory Manager" type="object" context="{'approved':False}"
                        groups="ng_store_requisition.ng_store_requisition_finance" />

                <button name="internal_confirmation" invisible="state != 'cpo'" string="Approve By CPO"
                        type="object" context="{'approved':True}" class="oe_highlight"
                        groups="ng_store_requisition.ng_store_requisition_procurement" />
                <button name="internal_confirmation" invisible="state != 'cpo'" string="Reject By CPO"
                        type="object" groups="ng_store_requisition.ng_store_requisition_procurement"
                        context="{'approved':False}" />

                <field name="state" widget="statusbar" statusbar_visible="draft,submit,approved,done"/>
            </header>
            <sheet>
                <field name="release_good" invisible="state not in ['approved', 'cpo']" readonly="1">
                </field>
                <group>
                    <group>
                        <field name="availaibility" column_invisible="1" />
                        <field name="name" readonly="1" />
                        <field name="requester" required="1" readonly="state != 'draft'" />
                        <field name="request_date" required="1" readonly="state != 'draft'" />
                        <field name="request_deadline" required="0" readonly="state != 'draft'" />
                        <field name="warehouse_id" invisible="state != 'warehouse'" required="state == 'warehouse'" />
                        <field name="company_id" invisible="1"/>
                    </group>
                    <group>
                        <field name="end_user" readonly="state != 'draft'" />
                        <field name="hod" readonly="state != 'draft'"/>
                        <field name="department" readonly="state != 'draft'" />
                        <field name="purchase_requisition_id" force_save="1" invisible="state in ['draft', 'submit']" />
                    </group>
                    <group>
                        <field name="src_location_id" domain="[('usage', '=', 'internal')]" required="state in ['audit', 'approved', 'approval']" invisible="state not in ['approval', 'audit', 'approved']" />
                    </group>
                    <group>
                        <field name="dst_location_id" invisible="state not in ['approval', 'audit', 'approved']" required="state in ['approval', 'audit', 'approved']" domain="[('usage', '!=', 'view')]" />
                    </group>
                </group>
                <notebook>
                    <page string='Rejection Reason' invisible="not reason or state != 'draft'">
                        <field name="reason" readonly="1" />
                    </page>
                    <page string='Requisition'>
                        <field name="approve_request_ids">
                            <list editable='bottom'>
                                <field name="product_id" required="1" />
                                <field name="quantity" required="1" />
                                <field name="uom" />
                                <field name="qty" string="Avail Qty" />
                                <field name="to_procure" column_invisible="1" />
                                <field name="transferred" readonly="1" />
                                <field name="state" string="State" />
                                <field name="button_show_state" column_invisible="1" />
                                <button name="procure" type="object" string="Procure" class="oe_link" invisible="state in ['available', 'awaiting']" groups="masterenergy_base_approval.group_store_officer" />
                            </list>
                        </field>
                    </page>
                </notebook>
            </sheet>
            <chatter/>
        </form>
    </field>
</record>

        <!-- actions opening views on models -->
        <record model="ir.actions.act_window" id="ng_store_requisition_action_window">
            <field name="name">Store Requisition</field>
            <field name="res_model">ng.store.request</field>
            <field name="view_mode">list,form</field>
            <field name="context">{'default_request_type': 'purchase'}</field>
            <field name="domain">[('request_type', '=', 'purchase')]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                </p>
            </field>
        </record>
        <!-- Top menu item -->
        <!--        <menuitem name="Store Requisition" -->
        <!--                  id="ng_internal_requisition_menu_root" -->
        <!--                  web_icon="ng_internal_requisition,static/description/icon.png" />-->
        <!-- menu categories -->
        <!--        parent="ng_internal_requisition_menu_root"-->
        <menuitem name="Store Requisition"
                  id="store_requisition_menu"
                  web_icon="ng_store_requisition,static/description/icon.png"
                  action="ng_store_requisition_action_window" />
        <!--        <menuitem name="Sale Requisition" id="sale_requisition_menu" parent="ng_internal_requisition_menu_root" action="ng_internal_requisition_action_window" />-->
        <!-- actions -->
    </data>
</odoo>